!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.JSEncrypt={})}(this,function(a){"use strict";function d(a){return c.charAt(a)}function e(a,b){return a&b}function f(a,b){return a|b}function g(a,b){return a^b}function h(a,b){return a&~b}function i(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function j(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function m(a){var b,c,d="";for(b=0;b+3<=a.length;b+=3)c=parseInt(a.substring(b,b+3),16),d+=k.charAt(c>>6)+k.charAt(63&c);for(b+1==a.length?(c=parseInt(a.substring(b,b+1),16),d+=k.charAt(c<<2)):b+2==a.length&&(c=parseInt(a.substring(b,b+2),16),d+=k.charAt(c>>2)+k.charAt((3&c)<<4));(3&d.length)>0;)d+=l;return d}function n(a){var c,g,b="",e=0,f=0;for(c=0;c<a.length&&a.charAt(c)!=l;++c)g=k.indexOf(a.charAt(c)),0>g||(0==e?(b+=d(g>>2),f=3&g,e=1):1==e?(b+=d(f<<2|g>>4),f=15&g,e=2):2==e?(b+=d(f),b+=d(g>>2),f=3&g,e=3):(b+=d(f<<2|g>>4),b+=d(15&g),e=0));return 1==e&&(b+=d(f<<2)),b}function p(a,b){function c(){this.constructor=a}o(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}function z(a,b){return a.length>b&&(a=a.substring(0,b)+w),a}function N(){return new I(null)}function O(a,b){return new I(a,b)}function P(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function Q(a,b,c,d,e,f){for(var i,j,k,g=32767&b,h=b>>15;--f>=0;)i=32767&this[a],j=this[a++]>>15,k=h*i+j*g,i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i;return e}function R(a,b,c,d,e,f){for(var i,j,k,g=16383&b,h=b>>14;--f>=0;)i=16383&this[a],j=this[a++]>>14,k=h*i+j*g,i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i;return e}function W(a,b){var c=T[a.charCodeAt(b)];return null==c?-1:c}function X(a){var b=N();return b.fromInt(a),b}function Y(a){var c,b=1;return 0!=(c=a>>>16)&&(a=c,b+=16),0!=(c=a>>8)&&(a=c,b+=8),0!=(c=a>>4)&&(a=c,b+=4),0!=(c=a>>2)&&(a=c,b+=2),0!=(c=a>>1)&&(a=c,b+=1),b}function $(){return new Z}function fb(){if(null==ab){for(ab=$();_>cb;){var a=Math.floor(65536*Math.random());bb[cb++]=255&a}for(ab.init(bb),cb=0;cb<bb.length;++cb)bb[cb]=0;cb=0}return ab.next()}function hb(a,b){var c,d,e,f;if(b<a.length+22)return console.error("Message too long for RSA"),null;for(c=b-a.length-6,d="",e=0;c>e;e+=2)d+="ff";return f="0001"+d+"00"+a,O(f,16)}function ib(a,b){var c,d,e,f,g;if(b<a.length+11)return console.error("Message too long for RSA"),null;for(c=[],d=a.length-1;d>=0&&b>0;)e=a.charCodeAt(d--),128>e?c[--b]=e:e>127&&2048>e?(c[--b]=128|63&e,c[--b]=192|e>>6):(c[--b]=128|63&e,c[--b]=128|63&e>>6,c[--b]=224|e>>12);for(c[--b]=0,f=new gb,g=[];b>2;){for(g[0]=0;0==g[0];)f.nextBytes(g);c[--b]=g[0]}return c[--b]=2,c[--b]=0,new I(c)}function kb(a,b){for(var e,f,c=a.toByteArray(),d=0;d<c.length&&0==c[d];)++d;if(c.length-d!=b-1||2!=c[d])return null;for(++d;0!=c[d];)if(++d>=c.length)return null;for(e="";++d<c.length;)f=255&c[d],128>f?e+=String.fromCharCode(f):f>191&&224>f?(e+=String.fromCharCode((31&f)<<6|63&c[d+1]),++d):(e+=String.fromCharCode((15&f)<<12|(63&c[d+1])<<6|63&c[d+2]),d+=2);return e}function mb(a){return lb[a]||""}function nb(a){var b,c,d;for(b in lb)if(lb.hasOwnProperty(b)&&(c=lb[b],d=c.length,a.substr(0,d)==c))return a.substr(d);return a}var q,s,D,S,T,U,V,Z,_,ab,bb,cb,gb,jb,lb,ob,pb,qb,rb,b={},c="0123456789abcdefghijklmnopqrstuvwxyz",k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l="=",o=function(a,b){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},o(a,b)},r={decode:function(a){var b,c,d,e,f,g,h;if(void 0===q){for(c="0123456789ABCDEF",d=" \f\n\r   \u2028\u2029",q={},b=0;16>b;++b)q[c.charAt(b)]=b;for(c=c.toLowerCase(),b=10;16>b;++b)q[c.charAt(b)]=b;for(b=0;b<d.length;++b)q[d.charAt(b)]=-1}for(e=[],f=0,g=0,b=0;b<a.length&&(h=a.charAt(b),"="!=h);++b)if(h=q[h],-1!=h){if(void 0===h)throw new Error("Illegal character at offset "+b);f|=h,++g>=2?(e[e.length]=f,f=0,g=0):f<<=4}if(g)throw new Error("Hex encoding incomplete: 4 bits missing");return e}},t={decode:function(a){var b,c,d,e,f,g,h;if(void 0===s){for(c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d="= \f\n\r  \u2028\u2029",s=Object.create(null),b=0;64>b;++b)s[c.charAt(b)]=b;for(b=0;b<d.length;++b)s[d.charAt(b)]=-1}for(e=[],f=0,g=0,b=0;b<a.length&&(h=a.charAt(b),"="!=h);++b)if(h=s[h],-1!=h){if(void 0===h)throw new Error("Illegal character at offset "+b);f|=h,++g>=4?(e[e.length]=f>>16,e[e.length]=255&f>>8,e[e.length]=255&f,f=0,g=0):f<<=6}switch(g){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:e[e.length]=f>>10;break;case 3:e[e.length]=f>>16,e[e.length]=255&f>>8}return e},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(a){var b=t.re.exec(a);if(b)if(b[1])a=b[1];else{if(!b[2])throw new Error("RegExp out of sync");a=b[2]}return t.decode(a)}},u=1e13,v=function(){function a(a){this.buf=[+a||0]}return a.prototype.mulAdd=function(a,b){var e,f,c=this.buf,d=c.length;for(e=0;d>e;++e)f=c[e]*a+b,u>f?b=0:(b=0|f/u,f-=b*u),c[e]=f;b>0&&(c[e]=b)},a.prototype.sub=function(a){var d,e,b=this.buf,c=b.length;for(d=0;c>d;++d)e=b[d]-a,0>e?(e+=u,a=1):a=0,b[d]=e;for(;0===b[b.length-1];)b.pop()},a.prototype.toString=function(a){var b,c,d;if(10!=(a||10))throw new Error("only base 10 is supported");for(b=this.buf,c=b[b.length-1].toString(),d=b.length-2;d>=0;--d)c+=(u+b[d]).toString().substring(1);return c},a.prototype.valueOf=function(){var c,a=this.buf,b=0;for(c=a.length-1;c>=0;--c)b=b*u+a[c];return b},a.prototype.simplify=function(){var a=this.buf;return 1==a.length?a[0]:this},a}(),w="…",x=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,y=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,A=function(){function a(b,c){this.hexDigits="0123456789ABCDEF",b instanceof a?(this.enc=b.enc,this.pos=b.pos):(this.enc=b,this.pos=c)}return a.prototype.get=function(a){if(void 0===a&&(a=this.pos++),a>=this.enc.length)throw new Error("Requesting byte offset "+a+" on a stream of length "+this.enc.length);return"string"==typeof this.enc?this.enc.charCodeAt(a):this.enc[a]},a.prototype.hexByte=function(a){return this.hexDigits.charAt(15&a>>4)+this.hexDigits.charAt(15&a)},a.prototype.hexDump=function(a,b,c){var e,d="";for(e=a;b>e;++e)if(d+=this.hexByte(this.get(e)),c!==!0)switch(15&e){case 7:d+="  ";break;case 15:d+="\n";break;default:d+=" "}return d},a.prototype.isASCII=function(a,b){var c,d;for(c=a;b>c;++c)if(d=this.get(c),32>d||d>176)return!1;return!0},a.prototype.parseStringISO=function(a,b){var d,c="";for(d=a;b>d;++d)c+=String.fromCharCode(this.get(d));return c},a.prototype.parseStringUTF=function(a,b){var d,e,c="";for(d=a;b>d;)e=this.get(d++),c+=128>e?String.fromCharCode(e):e>191&&224>e?String.fromCharCode((31&e)<<6|63&this.get(d++)):String.fromCharCode((15&e)<<12|(63&this.get(d++))<<6|63&this.get(d++));return c},a.prototype.parseStringBMP=function(a,b){var d,e,f,c="";for(f=a;b>f;)d=this.get(f++),e=this.get(f++),c+=String.fromCharCode(d<<8|e);return c},a.prototype.parseTime=function(a,b,c){var d=this.parseStringISO(a,b),e=(c?x:y).exec(d);return e?(c&&(e[1]=+e[1],e[1]+=+e[1]<70?2e3:1900),d=e[1]+"-"+e[2]+"-"+e[3]+" "+e[4],e[5]&&(d+=":"+e[5],e[6]&&(d+=":"+e[6],e[7]&&(d+="."+e[7]))),e[8]&&(d+=" UTC","Z"!=e[8]&&(d+=e[8],e[9]&&(d+=":"+e[9]))),d):"Unrecognized time: "+d},a.prototype.parseInteger=function(a,b){for(var f,h,i,c=this.get(a),d=c>127,e=d?255:0,g="";c==e&&++a<b;)c=this.get(a);if(f=b-a,0===f)return d?-1:0;if(f>4){for(g=c,f<<=3;0==(128&(+g^e));)g=+g<<1,--f;g="("+f+" bit)\n"}for(d&&(c-=256),h=new v(c),i=a+1;b>i;++i)h.mulAdd(256,this.get(i));return g+h.toString()},a.prototype.parseBitString=function(a,b,c){var h,i,j,k,d=this.get(a),e=(b-a-1<<3)-d,f="("+e+" bit)\n",g="";for(h=a+1;b>h;++h){for(i=this.get(h),j=h==b-1?d:0,k=7;k>=j;--k)g+=1&i>>k?"1":"0";if(g.length>c)return f+z(g,c)}return f+g},a.prototype.parseOctetString=function(a,b,c){var d,e,f;if(this.isASCII(a,b))return z(this.parseStringISO(a,b),c);for(d=b-a,e="("+d+" byte)\n",c/=2,d>c&&(b=a+c),f=a;b>f;++f)e+=this.hexByte(this.get(f));return d>c&&(e+=w),e},a.prototype.parseOID=function(a,b,c){var g,h,i,d="",e=new v,f=0;for(g=a;b>g;++g)if(h=this.get(g),e.mulAdd(128,127&h),f+=7,!(128&h)){if(""===d?(e=e.simplify(),e instanceof v?(e.sub(80),d="2."+e.toString()):(i=80>e?40>e?0:1:2,d=i+"."+(e-40*i))):d+="."+e.toString(),d.length>c)return z(d,c);e=new v,f=0}return f>0&&(d+=".incomplete"),d},a}(),B=function(){function a(a,b,c,d,e){if(!(d instanceof C))throw new Error("Invalid tag value.");this.stream=a,this.header=b,this.length=c,this.tag=d,this.sub=e}return a.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},a.prototype.content=function(a){var b,c;if(void 0===this.tag)return null;if(void 0===a&&(a=1/0),b=this.posContent(),c=Math.abs(this.length),!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(b,b+c,a);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(b)?"false":"true";case 2:return this.stream.parseInteger(b,b+c);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(b,b+c,a);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(b,b+c,a);case 6:return this.stream.parseOID(b,b+c,a);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return z(this.stream.parseStringUTF(b,b+c),a);case 18:case 19:case 20:case 21:case 22:case 26:return z(this.stream.parseStringISO(b,b+c),a);case 30:return z(this.stream.parseStringBMP(b,b+c),a);case 23:case 24:return this.stream.parseTime(b,b+c,23==this.tag.tagNumber)}return null},a.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},a.prototype.toPrettyString=function(a){var b,c,d;if(void 0===a&&(a=""),b=a+this.typeName()+" @"+this.stream.pos,this.length>=0&&(b+="+"),b+=this.length,this.tag.tagConstructed?b+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&4!=this.tag.tagNumber||null===this.sub||(b+=" (encapsulates)"),b+="\n",null!==this.sub)for(a+="  ",c=0,d=this.sub.length;d>c;++c)b+=this.sub[c].toPrettyString(a);return b},a.prototype.posStart=function(){return this.stream.pos},a.prototype.posContent=function(){return this.stream.pos+this.header},a.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},a.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},a.decodeLength=function(a){var d,b=a.get(),c=127&b;if(c==b)return c;if(c>6)throw new Error("Length over 48 bits not supported at position "+(a.pos-1));if(0===c)return null;for(b=0,d=0;c>d;++d)b=256*b+a.get();return b},a.prototype.getHexStringValue=function(){var a=this.toHexString(),b=2*this.header,c=2*this.length;return a.substr(b,c)},a.decode=function(b){var c,d,e,f,g,h,i,j,k;if(c=b instanceof A?b:new A(b,0),d=new A(c),e=new C(c),f=a.decodeLength(c),g=c.pos,h=g-d.pos,i=null,j=function(){var d,e,b=[];if(null!==f){for(d=g+f;c.pos<d;)b[b.length]=a.decode(c);if(c.pos!=d)throw new Error("Content size is not correct for container starting at offset "+g)}else try{for(;e=a.decode(c),!e.tag.isEOC();)b[b.length]=e;f=g-c.pos}catch(h){throw new Error("Exception while decoding undefined length content: "+h)}return b},e.tagConstructed)i=j();else if(e.isUniversal()&&(3==e.tagNumber||4==e.tagNumber))try{if(3==e.tagNumber&&0!=c.get())throw new Error("BIT STRINGs with unused bits cannot encapsulate.");for(i=j(),k=0;k<i.length;++k)if(i[k].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch(l){i=null}if(null===i){if(null===f)throw new Error("We can't skip over an invalid tag with undefined length at offset "+g);c.pos=g+Math.abs(f)}return new a(d,h,f,e,i)},a}(),C=function(){function a(a){var c,b=a.get();if(this.tagClass=b>>6,this.tagConstructed=0!==(32&b),this.tagNumber=31&b,31==this.tagNumber){c=new v;do b=a.get(),c.mulAdd(128,127&b);while(128&b);this.tagNumber=c.simplify()}}return a.prototype.isUniversal=function(){return 0===this.tagClass},a.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},a}(),E=0xdeadbeefcafe,F=15715070==(16777215&E),G=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],H=(1<<26)/G[G.length-1],I=function(){function a(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}return a.prototype.toString=function(a){var b,c,e,f,g,h,i;if(this.s<0)return"-"+this.negate().toString(a);if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}if(c=(1<<b)-1,f=!1,g="",h=this.t,i=this.DB-h*this.DB%b,h-->0)for(i<this.DB&&(e=this[h]>>i)>0&&(f=!0,g=d(e));h>=0;)b>i?(e=(this[h]&(1<<i)-1)<<b-i,e|=this[--h]>>(i+=this.DB-b)):(e=this[h]>>(i-=b)&c,0>=i&&(i+=this.DB,--h)),e>0&&(f=!0),f&&(g+=d(e));return f?g:"0"},a.prototype.negate=function(){var b=N();return a.ZERO.subTo(this,b),b},a.prototype.abs=function(){return this.s<0?this.negate():this},a.prototype.compareTo=function(a){var c,b=this.s-a.s;if(0!=b)return b;if(c=this.t,b=c-a.t,0!=b)return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0},a.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+Y(this[this.t-1]^this.s&this.DM)},a.prototype.mod=function(b){var c=N();return this.abs().divRemTo(b,null,c),this.s<0&&c.compareTo(a.ZERO)>0&&b.subTo(c,c),c},a.prototype.modPowInt=function(a,b){var c;return c=256>a||b.isEven()?new K(b):new L(b),this.exp(a,c)},a.prototype.clone=function(){var a=N();return this.copyTo(a),a},a.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},a.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},a.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},a.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},a.prototype.toByteArray=function(){var c,d,e,a=this.t,b=[];if(b[0]=this.s,c=this.DB-a*this.DB%8,e=0,a-->0)for(c<this.DB&&(d=this[a]>>c)!=(this.s&this.DM)>>c&&(b[e++]=d|this.s<<this.DB-c);a>=0;)8>c?(d=(this[a]&(1<<c)-1)<<8-c,d|=this[--a]>>(c+=this.DB-8)):(d=255&this[a]>>(c-=8),0>=c&&(c+=this.DB,--a)),0!=(128&d)&&(d|=-256),0==e&&(128&this.s)!=(128&d)&&++e,(e>0||d!=this.s)&&(b[e++]=d);return b},a.prototype.equals=function(a){return 0==this.compareTo(a)},a.prototype.min=function(a){return this.compareTo(a)<0?this:a},a.prototype.max=function(a){return this.compareTo(a)>0?this:a},a.prototype.and=function(a){var b=N();return this.bitwiseTo(a,e,b),b},a.prototype.or=function(a){var b=N();return this.bitwiseTo(a,f,b),b},a.prototype.xor=function(a){var b=N();return this.bitwiseTo(a,g,b),b},a.prototype.andNot=function(a){var b=N();return this.bitwiseTo(a,h,b),b},a.prototype.not=function(){var b,a=N();for(b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a},a.prototype.shiftLeft=function(a){var b=N();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b},a.prototype.shiftRight=function(a){var b=N();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b},a.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+i(this[a]);return this.s<0?this.t*this.DB:-1},a.prototype.bitCount=function(){var c,a=0,b=this.s&this.DM;for(c=0;c<this.t;++c)a+=j(this[c]^b);return a},a.prototype.testBit=function(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)},a.prototype.setBit=function(a){return this.changeBit(a,f)},a.prototype.clearBit=function(a){return this.changeBit(a,h)},a.prototype.flipBit=function(a){return this.changeBit(a,g)},a.prototype.add=function(a){var b=N();return this.addTo(a,b),b},a.prototype.subtract=function(a){var b=N();return this.subTo(a,b),b},a.prototype.multiply=function(a){var b=N();return this.multiplyTo(a,b),b},a.prototype.divide=function(a){var b=N();return this.divRemTo(a,b,null),b},a.prototype.remainder=function(a){var b=N();return this.divRemTo(a,null,b),b},a.prototype.divideAndRemainder=function(a){var b=N(),c=N();return this.divRemTo(a,b,c),[b,c]},a.prototype.modPow=function(a,b){var d,f,g,h,i,j,k,l,m,n,o,p,c=a.bitLength(),e=X(1);if(0>=c)return e;if(d=18>c?1:48>c?3:144>c?4:768>c?5:6,f=8>c?new K(b):b.isEven()?new M(b):new L(b),g=[],h=3,i=d-1,j=(1<<d)-1,g[1]=f.convert(this),d>1)for(k=N(),f.sqrTo(g[1],k);j>=h;)g[h]=N(),f.mulTo(k,g[h-2],g[h]),h+=2;for(l=a.t-1,n=!0,o=N(),c=Y(a[l])-1;l>=0;){for(c>=i?m=a[l]>>c-i&j:(m=(a[l]&(1<<c+1)-1)<<i-c,l>0&&(m|=a[l-1]>>this.DB+c-i)),h=d;0==(1&m);)m>>=1,--h;if((c-=h)<0&&(c+=this.DB,--l),n)g[m].copyTo(e),n=!1;else{for(;h>1;)f.sqrTo(e,o),f.sqrTo(o,e),h-=2;h>0?f.sqrTo(e,o):(p=e,e=o,o=p),f.mulTo(o,g[m],e)}for(;l>=0&&0==(a[l]&1<<c);)f.sqrTo(e,o),p=e,e=o,o=p,--c<0&&(c=this.DB-1,--l)}return f.revert(e)},a.prototype.modInverse=function(b){var d,e,f,g,h,i,c=b.isEven();if(this.isEven()&&c||0==b.signum())return a.ZERO;for(d=b.clone(),e=this.clone(),f=X(1),g=X(0),h=X(0),i=X(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),c?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(b,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(b,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),c?(h.isEven()&&i.isEven()||(h.addTo(this,h),i.subTo(b,i)),h.rShiftTo(1,h)):i.isEven()||i.subTo(b,i),i.rShiftTo(1,i);d.compareTo(e)>=0?(d.subTo(e,d),c&&f.subTo(h,f),g.subTo(i,g)):(e.subTo(d,e),c&&h.subTo(f,h),i.subTo(g,i))}return 0!=e.compareTo(a.ONE)?a.ZERO:i.compareTo(b)>=0?i.subtract(b):i.signum()<0?(i.addTo(b,i),i.signum()<0?i.add(b):i):i},a.prototype.pow=function(a){return this.exp(a,new J)},a.prototype.gcd=function(a){var d,e,f,b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0&&(d=b,b=c,c=d),e=b.getLowestSetBit(),f=c.getLowestSetBit(),0>f)return b;for(f>e&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c},a.prototype.isProbablePrime=function(a){var b,d,e,c=this.abs();if(1==c.t&&c[0]<=G[G.length-1]){for(b=0;b<G.length;++b)if(c[0]==G[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<G.length;){for(d=G[b],e=b+1;e<G.length&&H>d;)d*=G[e++];for(d=c.modInt(d);e>b;)if(0==d%G[b++])return!1}return c.millerRabin(a)},a.prototype.copyTo=function(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s},a.prototype.fromInt=function(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+this.DV:this.t=0},a.prototype.fromString=function(b,c){var d,e,f,g,h;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else{if(4!=c)return this.fromRadix(b,c),void 0;d=2}for(this.t=0,this.s=0,e=b.length,f=!1,g=0;--e>=0;)h=8==d?255&+b[e]:W(b,e),0>h?"-"==b.charAt(e)&&(f=!0):(f=!1,0==g?this[this.t++]=h:g+d>this.DB?(this[this.t-1]|=(h&(1<<this.DB-g)-1)<<g,this[this.t++]=h>>this.DB-g):this[this.t-1]|=h<<g,g+=d,g>=this.DB&&(g-=this.DB));8==d&&0!=(128&+b[0])&&(this.s=-1,g>0&&(this[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&a.ZERO.subTo(this,this)},a.prototype.clamp=function(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t},a.prototype.dlShiftTo=function(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s},a.prototype.drShiftTo=function(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s},a.prototype.lShiftTo=function(a,b){var h,c=a%this.DB,d=this.DB-c,e=(1<<d)-1,f=Math.floor(a/this.DB),g=this.s<<c&this.DM;for(h=this.t-1;h>=0;--h)b[h+f+1]=this[h]>>d|g,g=(this[h]&e)<<c;for(h=f-1;h>=0;--h)b[h]=0;b[f]=g,b.t=this.t+f+1,b.s=this.s,b.clamp()},a.prototype.rShiftTo=function(a,b){var c,d,e,f,g;if(b.s=this.s,c=Math.floor(a/this.DB),c>=this.t)return b.t=0,void 0;for(d=a%this.DB,e=this.DB-d,f=(1<<d)-1,b[0]=this[c]>>d,g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()},a.prototype.subTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()},a.prototype.multiplyTo=function(b,c){var d=this.abs(),e=b.abs(),f=d.t;for(c.t=f+e.t;--f>=0;)c[f]=0;for(f=0;f<e.t;++f)c[f+d.t]=d.am(0,e[f],c,f,0,d.t);c.s=0,c.clamp(),this.s!=b.s&&a.ZERO.subTo(c,c)},a.prototype.squareTo=function(a){for(var d,b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c)d=b.am(c,b[c],a,2*c,0,1),(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1);a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()},a.prototype.divRemTo=function(b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,e=b.abs();if(!(e.t<=0)){if(f=this.abs(),f.t<e.t)return null!=c&&c.fromInt(0),null!=d&&this.copyTo(d),void 0;if(null==d&&(d=N()),g=N(),h=this.s,i=b.s,j=this.DB-Y(e[e.t-1]),j>0?(e.lShiftTo(j,g),f.lShiftTo(j,d)):(e.copyTo(g),f.copyTo(d)),k=g.t,l=g[k-1],0!=l){for(m=l*(1<<this.F1)+(k>1?g[k-2]>>this.F2:0),n=this.FV/m,o=(1<<this.F1)/m,p=1<<this.F2,q=d.t,r=q-k,s=null==c?N():c,g.dlShiftTo(r,s),d.compareTo(s)>=0&&(d[d.t++]=1,d.subTo(s,d)),a.ONE.dlShiftTo(k,s),s.subTo(g,g);g.t<k;)g[g.t++]=0;for(;--r>=0;)if(t=d[--q]==l?this.DM:Math.floor(d[q]*n+(d[q-1]+p)*o),(d[q]+=g.am(0,t,d,r,0,k))<t)for(g.dlShiftTo(r,s),d.subTo(s,d);d[q]<--t;)d.subTo(s,d);null!=c&&(d.drShiftTo(k,c),h!=i&&a.ZERO.subTo(c,c)),d.t=k,d.clamp(),j>0&&d.rShiftTo(j,d),0>h&&a.ZERO.subTo(d,d)}}},a.prototype.invDigit=function(){var a,b;return this.t<1?0:(a=this[0],0==(1&a)?0:(b=3&a,b=15&b*(2-(15&a)*b),b=255&b*(2-(255&a)*b),b=65535&b*(2-(65535&(65535&a)*b)),b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b))},a.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},a.prototype.exp=function(b,c){var d,e,f,g,h;if(b>4294967295||1>b)return a.ONE;for(d=N(),e=N(),f=c.convert(this),g=Y(b)-1,f.copyTo(d);--g>=0;)c.sqrTo(d,e),(b&1<<g)>0?c.mulTo(e,f,d):(h=d,d=e,e=h);return c.revert(d)},a.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))},a.prototype.toRadix=function(a){var b,c,d,e,f,g;if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";for(b=this.chunkSize(a),c=Math.pow(a,b),d=X(c),e=N(),f=N(),g="",this.divRemTo(d,e,f);e.signum()>0;)g=(c+f.intValue()).toString(a).substr(1)+g,e.divRemTo(d,e,f);return f.intValue().toString(a)+g},a.prototype.fromRadix=function(b,c){var d,e,f,g,h,i,j;for(this.fromInt(0),null==c&&(c=10),d=this.chunkSize(c),e=Math.pow(c,d),f=!1,g=0,h=0,i=0;i<b.length;++i)j=W(b,i),0>j?"-"==b.charAt(i)&&0==this.signum()&&(f=!0):(h=c*h+j,++g>=d&&(this.dMultiply(e),this.dAddOffset(h,0),g=0,h=0));g>0&&(this.dMultiply(Math.pow(c,g)),this.dAddOffset(h,0)),f&&a.ZERO.subTo(this,this)},a.prototype.fromNumber=function(b,c,d){var e,g;if("number"==typeof c)if(2>b)this.fromInt(1);else for(this.fromNumber(b,d),this.testBit(b-1)||this.bitwiseTo(a.ONE.shiftLeft(b-1),f,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>b&&this.subTo(a.ONE.shiftLeft(b-1),this);else e=[],g=7&b,e.length=(b>>3)+1,c.nextBytes(e),g>0?e[0]&=(1<<g)-1:e[0]=0,this.fromString(e,256)},a.prototype.bitwiseTo=function(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()},a.prototype.changeBit=function(b,c){var d=a.ONE.shiftLeft(b);return this.bitwiseTo(d,c,d),d},a.prototype.addTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b[c++]=d:-1>d&&(b[c++]=this.DV+d),b.t=c,b.clamp()},a.prototype.dMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()},a.prototype.dAddOffset=function(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}},a.prototype.multiplyLowerTo=function(a,b,c){var e,d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;for(e=c.t-this.t;e>d;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()},a.prototype.multiplyUpperTo=function(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)},a.prototype.modInt=function(a){var b,c,d;if(0>=a)return 0;if(b=this.DV%a,c=this.s<0?a-1:0,this.t>0)if(0==b)c=this[0]%a;else for(d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c},a.prototype.millerRabin=function(b){var e,f,g,h,i,c=this.subtract(a.ONE),d=c.getLowestSetBit();if(0>=d)return!1;for(e=c.shiftRight(d),b=b+1>>1,b>G.length&&(b=G.length),f=N(),g=0;b>g;++g)if(f.fromInt(G[Math.floor(Math.random()*G.length)]),h=f.modPow(e,this),0!=h.compareTo(a.ONE)&&0!=h.compareTo(c)){for(i=1;i++<d&&0!=h.compareTo(c);)if(h=h.modPowInt(2,this),0==h.compareTo(a.ONE))return!1;if(0!=h.compareTo(c))return!1}return!0},a.prototype.square=function(){var a=N();return this.squareTo(a),a},a.prototype.gcda=function(a,b){var e,f,g,h,c=this.s<0?this.negate():this.clone(),d=a.s<0?a.negate():a.clone();return c.compareTo(d)<0&&(e=c,c=d,d=e),f=c.getLowestSetBit(),g=d.getLowestSetBit(),0>g?(b(c),void 0):(g>f&&(g=f),g>0&&(c.rShiftTo(g,c),d.rShiftTo(g,d)),h=function(){(f=c.getLowestSetBit())>0&&c.rShiftTo(f,c),(f=d.getLowestSetBit())>0&&d.rShiftTo(f,d),c.compareTo(d)>=0?(c.subTo(d,c),c.rShiftTo(1,c)):(d.subTo(c,d),d.rShiftTo(1,d)),c.signum()>0?setTimeout(h,0):(g>0&&d.lShiftTo(g,d),setTimeout(function(){b(d)},0))},setTimeout(h,10),void 0)},a.prototype.fromNumberAsync=function(b,c,d,e){var g,h,i,j;"number"==typeof c?2>b?this.fromInt(1):(this.fromNumber(b,d),this.testBit(b-1)||this.bitwiseTo(a.ONE.shiftLeft(b-1),f,this),this.isEven()&&this.dAddOffset(1,0),g=this,h=function(){g.dAddOffset(2,0),g.bitLength()>b&&g.subTo(a.ONE.shiftLeft(b-1),g),g.isProbablePrime(c)?setTimeout(function(){e()},0):setTimeout(h,0)},setTimeout(h,0)):(i=[],j=7&b,i.length=(b>>3)+1,c.nextBytes(i),j>0?i[0]&=(1<<j)-1:i[0]=0,this.fromString(i,256))},a}(),J=function(){function a(){}return a.prototype.convert=function(a){return a},a.prototype.revert=function(a){return a},a.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c)},a.prototype.sqrTo=function(a,b){a.squareTo(b)},a}(),K=function(){function a(a){this.m=a}return a.prototype.convert=function(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a},a.prototype.revert=function(a){return a},a.prototype.reduce=function(a){a.divRemTo(this.m,null,a)},a.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},a.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},a}(),L=function(){function a(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}return a.prototype.convert=function(a){var b=N();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(I.ZERO)>0&&this.m.subTo(b,b),b},a.prototype.revert=function(a){var b=N();return a.copyTo(b),this.reduce(b),b},a.prototype.reduce=function(a){for(var b,c,d;a.t<=this.mt2;)a[a.t++]=0;for(b=0;b<this.m.t;++b)for(c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM,c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++;a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)},a.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},a.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},a}(),M=function(){function a(a){this.m=a,this.r2=N(),this.q3=N(),I.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a)}return a.prototype.convert=function(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=N();return a.copyTo(b),this.reduce(b),b},a.prototype.revert=function(a){return a},a.prototype.reduce=function(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)},a.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},a.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},a}();for(F&&"Microsoft Internet Explorer"==b.appName?(I.prototype.am=Q,D=30):F&&"Netscape"!=b.appName?(I.prototype.am=P,D=26):(I.prototype.am=R,D=28),I.prototype.DB=D,I.prototype.DM=(1<<D)-1,I.prototype.DV=1<<D,S=52,I.prototype.FV=Math.pow(2,S),I.prototype.F1=S-D,I.prototype.F2=2*D-S,T=[],U="0".charCodeAt(0),V=0;9>=V;++V)T[U++]=V;for(U="a".charCodeAt(0),V=10;36>V;++V)T[U++]=V;for(U="A".charCodeAt(0),V=10;36>V;++V)T[U++]=V;I.ZERO=X(0),I.ONE=X(1),Z=function(){function a(){this.i=0,this.j=0,this.S=[]}return a.prototype.init=function(a){var b,c,d;for(b=0;256>b;++b)this.S[b]=b;for(c=0,b=0;256>b;++b)c=255&c+this.S[b]+a[b%a.length],d=this.S[b],this.S[b]=this.S[c],this.S[c]=d;this.i=0,this.j=0},a.prototype.next=function(){var a;return this.i=255&this.i+1,this.j=255&this.j+this.S[this.i],a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[255&a+this.S[this.i]]},a}(),_=256,bb=null,null==bb&&(bb=[],cb=0),gb=function(){function a(){}return a.prototype.nextBytes=function(a){for(var b=0;b<a.length;++b)a[b]=fb()},a}(),jb=function(){function a(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null
}return a.prototype.doPublic=function(a){return a.modPowInt(this.e,this.n)},a.prototype.doPrivate=function(a){var b,c;if(null==this.p||null==this.q)return a.modPow(this.d,this.n);for(b=a.mod(this.p).modPow(this.dmp1,this.p),c=a.mod(this.q).modPow(this.dmq1,this.q);b.compareTo(c)<0;)b=b.add(this.p);return b.subtract(c).multiply(this.coeff).mod(this.p).multiply(this.q).add(c)},a.prototype.setPublic=function(a,b){null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=O(a,16),this.e=parseInt(b,16)):console.error("Invalid RSA public key")},a.prototype.encrypt=function(a){var c,d,b=ib(a,this.n.bitLength()+7>>3);return null==b?null:(c=this.doPublic(b),null==c?null:(d=c.toString(16),0==(1&d.length)?d:"0"+d))},a.prototype.setPrivate=function(a,b,c){null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=O(a,16),this.e=parseInt(b,16),this.d=O(c,16)):console.error("Invalid RSA private key")},a.prototype.setPrivateEx=function(a,b,c,d,e,f,g,h){null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=O(a,16),this.e=parseInt(b,16),this.d=O(c,16),this.p=O(d,16),this.q=O(e,16),this.dmp1=O(f,16),this.dmq1=O(g,16),this.coeff=O(h,16)):console.error("Invalid RSA private key")},a.prototype.generate=function(a,b){var e,f,g,h,i,c=new gb,d=a>>1;for(this.e=parseInt(b,16),e=new I(b,16);;){for(;this.p=new I(a-d,1,c),0!=this.p.subtract(I.ONE).gcd(e).compareTo(I.ONE)||!this.p.isProbablePrime(10););for(;this.q=new I(d,1,c),0!=this.q.subtract(I.ONE).gcd(e).compareTo(I.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0&&(f=this.p,this.p=this.q,this.q=f),g=this.p.subtract(I.ONE),h=this.q.subtract(I.ONE),i=g.multiply(h),0==i.gcd(e).compareTo(I.ONE)){this.n=this.p.multiply(this.q),this.d=e.modInverse(i),this.dmp1=this.d.mod(g),this.dmq1=this.d.mod(h),this.coeff=this.q.modInverse(this.p);break}}},a.prototype.decrypt=function(a){var b=O(a,16),c=this.doPrivate(b);return null==c?null:kb(c,this.n.bitLength()+7>>3)},a.prototype.generateAsync=function(a,b,c){var f,g,h,d=new gb,e=a>>1;this.e=parseInt(b,16),f=new I(b,16),g=this,h=function(){var b=function(){var a,b,d,e;g.p.compareTo(g.q)<=0&&(a=g.p,g.p=g.q,g.q=a),b=g.p.subtract(I.ONE),d=g.q.subtract(I.ONE),e=b.multiply(d),0==e.gcd(f).compareTo(I.ONE)?(g.n=g.p.multiply(g.q),g.d=f.modInverse(e),g.dmp1=g.d.mod(b),g.dmq1=g.d.mod(d),g.coeff=g.q.modInverse(g.p),setTimeout(function(){c()},0)):setTimeout(h,0)},i=function(){g.q=N(),g.q.fromNumberAsync(e,1,d,function(){g.q.subtract(I.ONE).gcda(f,function(a){0==a.compareTo(I.ONE)&&g.q.isProbablePrime(10)?setTimeout(b,0):setTimeout(i,0)})})},j=function(){g.p=N(),g.p.fromNumberAsync(a-e,1,d,function(){g.p.subtract(I.ONE).gcda(f,function(a){0==a.compareTo(I.ONE)&&g.p.isProbablePrime(10)?setTimeout(i,0):setTimeout(j,0)})})};setTimeout(j,0)},setTimeout(h,0)},a.prototype.sign=function(a,b,c){var g,h,d=mb(c),e=d+b(a).toString(),f=hb(e,this.n.bitLength()/4);return null==f?null:(g=this.doPrivate(f),null==g?null:(h=g.toString(16),0==(1&h.length)?h:"0"+h))},a.prototype.verify=function(a,b,c){var f,g,d=O(b,16),e=this.doPublic(d);return null==e?null:(f=e.toString(16).replace(/^1f+00/,""),g=nb(f),g==c(a).toString())},a}(),lb={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"},ob={},ob.lang={extend:function(a,c,d){var e,f,g,h;if(!c||!a)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");if(e=function(){},e.prototype=c.prototype,a.prototype=new e,a.prototype.constructor=a,a.superclass=c.prototype,c.prototype.constructor==Object.prototype.constructor&&(c.prototype.constructor=c),d){for(f in d)a.prototype[f]=d[f];g=function(){},h=["toString","valueOf"];try{/MSIE/.test(b.userAgent)&&(g=function(a,b){for(f=0;f<h.length;f+=1){var c=h[f],d=b[c];"function"==typeof d&&d!=Object.prototype[c]&&(a[c]=d)}})}catch(i){}g(a.prototype,d)}}},pb={},"undefined"!=typeof pb.asn1&&pb.asn1||(pb.asn1={}),pb.asn1.ASN1Util=new function(){this.integerToByteHex=function(a){var b=a.toString(16);return 1==b.length%2&&(b="0"+b),b},this.bigIntToMinTwosComplementsHex=function(a){var c,d,e,f,g,h,b=a.toString(16);if("-"!=b.substr(0,1))1==b.length%2?b="0"+b:b.match(/^[0-7]/)||(b="00"+b);else{for(c=b.substr(1),d=c.length,1==d%2?d+=1:b.match(/^[0-7]/)||(d+=2),e="",f=0;d>f;f++)e+="f";g=new I(e,16),h=g.xor(a).add(I.ONE),b=h.toString(16).replace(/^-/,"")}return b},this.getPEMStringFromHex=function(a,b){return hextopem(a,b)},this.newObject=function(a){var w,x,y,z,A,B,C,D,b=pb,c=b.asn1,d=c.DERBoolean,e=c.DERInteger,f=c.DERBitString,g=c.DEROctetString,h=c.DERNull,i=c.DERObjectIdentifier,j=c.DEREnumerated,k=c.DERUTF8String,l=c.DERNumericString,m=c.DERPrintableString,n=c.DERTeletexString,o=c.DERIA5String,p=c.DERUTCTime,q=c.DERGeneralizedTime,r=c.DERSequence,s=c.DERSet,t=c.DERTaggedObject,u=c.ASN1Util.newObject,v=Object.keys(a);if(1!=v.length)throw"key of param shall be only one.";if(w=v[0],-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+w+":"))throw"undefined key: "+w;if("bool"==w)return new d(a[w]);if("int"==w)return new e(a[w]);if("bitstr"==w)return new f(a[w]);if("octstr"==w)return new g(a[w]);if("null"==w)return new h(a[w]);if("oid"==w)return new i(a[w]);if("enum"==w)return new j(a[w]);if("utf8str"==w)return new k(a[w]);if("numstr"==w)return new l(a[w]);if("prnstr"==w)return new m(a[w]);if("telstr"==w)return new n(a[w]);if("ia5str"==w)return new o(a[w]);if("utctime"==w)return new p(a[w]);if("gentime"==w)return new q(a[w]);if("seq"==w){for(x=a[w],y=[],z=0;z<x.length;z++)A=u(x[z]),y.push(A);return new r({array:y})}if("set"==w){for(x=a[w],y=[],z=0;z<x.length;z++)A=u(x[z]),y.push(A);return new s({array:y})}if("tag"==w){if(B=a[w],"[object Array]"===Object.prototype.toString.call(B)&&3==B.length)return C=u(B[2]),new t({tag:B[0],explicit:B[1],obj:C});if(D={},void 0!==B.explicit&&(D.explicit=B.explicit),void 0!==B.tag&&(D.tag=B.tag),void 0===B.obj)throw"obj shall be specified for 'tag'.";return D.obj=u(B.obj),new t(D)}},this.jsonToASN1HEX=function(a){var b=this.newObject(a);return b.getEncodedHex()}},pb.asn1.ASN1Util.oidHexToInt=function(a){var f,g,h,i,j,b="",c=parseInt(a.substr(0,2),16),d=Math.floor(c/40),e=c%40;for(b=d+"."+e,f="",g=2;g<a.length;g+=2)h=parseInt(a.substr(g,2),16),i=("00000000"+h.toString(2)).slice(-8),f+=i.substr(1,7),"0"==i.substr(0,1)&&(j=new I(f,2),b=b+"."+j.toString(10),f="");return b},pb.asn1.ASN1Util.oidIntToHex=function(a){var d,e,f,g,b=function(a){var b=a.toString(16);return 1==b.length&&(b="0"+b),b},c=function(a){var g,h,i,c="",d=new I(a,10),e=d.toString(2),f=7-e.length%7;for(7==f&&(f=0),g="",h=0;f>h;h++)g+="0";for(e=g+e,h=0;h<e.length-1;h+=7)i=e.substr(h,7),h!=e.length-7&&(i="1"+i),c+=b(parseInt(i,2));return c};if(!a.match(/^[0-9.]+$/))throw"malformed oid string: "+a;for(d="",e=a.split("."),f=40*parseInt(e[0])+parseInt(e[1]),d+=b(f),e.splice(0,2),g=0;g<e.length;g++)d+=c(e[g]);return d},pb.asn1.ASN1Object=function(){var a="";this.getLengthHexFromValue=function(){var b,c,d,e;if("undefined"==typeof this.hV||null==this.hV)throw"this.hV is null or undefined.";if(1==this.hV.length%2)throw"value hex must be even length: n="+a.length+",v="+this.hV;if(b=this.hV.length/2,c=b.toString(16),1==c.length%2&&(c="0"+c),128>b)return c;if(d=c.length/2,d>15)throw"ASN.1 length too long to represent by 8x: n = "+b.toString(16);return e=128+d,e.toString(16)+c},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},pb.asn1.DERAbstractString=function(a){pb.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(a){this.hTLV=null,this.isModified=!0,this.s=a,this.hV=stohex(this.s)},this.setStringHex=function(a){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=a},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("string"==typeof a?this.setString(a):"undefined"!=typeof a["str"]?this.setString(a["str"]):"undefined"!=typeof a["hex"]&&this.setStringHex(a["hex"]))},ob.lang.extend(pb.asn1.DERAbstractString,pb.asn1.ASN1Object),pb.asn1.DERAbstractTime=function(){pb.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(a){utc=a.getTime()+6e4*a.getTimezoneOffset();var b=new Date(utc);return b},this.formatDate=function(a,b,c){var g,h,i,j,k,l,m,n,d=this.zeroPadding,e=this.localDateToUTC(a),f=String(e.getFullYear());return"utc"==b&&(f=f.substr(2,2)),g=d(String(e.getMonth()+1),2),h=d(String(e.getDate()),2),i=d(String(e.getHours()),2),j=d(String(e.getMinutes()),2),k=d(String(e.getSeconds()),2),l=f+g+h+i+j+k,c===!0&&(m=e.getMilliseconds(),0!=m&&(n=d(String(m),3),n=n.replace(/[0]+$/,""),l=l+"."+n)),l+"Z"},this.zeroPadding=function(a,b){return a.length>=b?a:new Array(b-a.length+1).join("0")+a},this.getString=function(){return this.s},this.setString=function(a){this.hTLV=null,this.isModified=!0,this.s=a,this.hV=stohex(a)},this.setByDateValue=function(a,b,c,d,e,f){var g=new Date(Date.UTC(a,b-1,c,d,e,f,0));this.setByDate(g)},this.getFreshValueHex=function(){return this.hV}},ob.lang.extend(pb.asn1.DERAbstractTime,pb.asn1.ASN1Object),pb.asn1.DERAbstractStructured=function(a){pb.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(a){this.hTLV=null,this.isModified=!0,this.asn1Array=a},this.appendASN1Object=function(a){this.hTLV=null,this.isModified=!0,this.asn1Array.push(a)},this.asn1Array=new Array,"undefined"!=typeof a&&"undefined"!=typeof a["array"]&&(this.asn1Array=a["array"])},ob.lang.extend(pb.asn1.DERAbstractStructured,pb.asn1.ASN1Object),pb.asn1.DERBoolean=function(){pb.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},ob.lang.extend(pb.asn1.DERBoolean,pb.asn1.ASN1Object),pb.asn1.DERInteger=function(a){pb.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(a){this.hTLV=null,this.isModified=!0,this.hV=pb.asn1.ASN1Util.bigIntToMinTwosComplementsHex(a)},this.setByInteger=function(a){var b=new I(String(a),10);this.setByBigInteger(b)},this.setValueHex=function(a){this.hV=a},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("undefined"!=typeof a["bigint"]?this.setByBigInteger(a["bigint"]):"undefined"!=typeof a["int"]?this.setByInteger(a["int"]):"number"==typeof a?this.setByInteger(a):"undefined"!=typeof a["hex"]&&this.setValueHex(a["hex"]))},ob.lang.extend(pb.asn1.DERInteger,pb.asn1.ASN1Object),pb.asn1.DERBitString=function(a){if(void 0!==a&&"undefined"!=typeof a.obj){var b=pb.asn1.ASN1Util.newObject(a.obj);a.hex="00"+b.getEncodedHex()}pb.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(a){this.hTLV=null,this.isModified=!0,this.hV=a},this.setUnusedBitsAndHexValue=function(a,b){if(0>a||a>7)throw"unused bits shall be from 0 to 7: u = "+a;var c="0"+a;this.hTLV=null,this.isModified=!0,this.hV=c+b},this.setByBinaryString=function(a){var b,c,d,e,f;for(a=a.replace(/0+$/,""),b=8-a.length%8,8==b&&(b=0),c=0;b>=c;c++)a+="0";for(d="",c=0;c<a.length-1;c+=8)e=a.substr(c,8),f=parseInt(e,2).toString(16),1==f.length&&(f="0"+f),d+=f;this.hTLV=null,this.isModified=!0,this.hV="0"+b+d},this.setByBooleanArray=function(a){var c,b="";for(c=0;c<a.length;c++)b+=1==a[c]?"1":"0";this.setByBinaryString(b)},this.newFalseArray=function(a){var c,b=new Array(a);for(c=0;a>c;c++)b[c]=!1;return b},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("string"==typeof a&&a.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(a):"undefined"!=typeof a["hex"]?this.setHexValueIncludingUnusedBits(a["hex"]):"undefined"!=typeof a["bin"]?this.setByBinaryString(a["bin"]):"undefined"!=typeof a["array"]&&this.setByBooleanArray(a["array"]))},ob.lang.extend(pb.asn1.DERBitString,pb.asn1.ASN1Object),pb.asn1.DEROctetString=function(a){if(void 0!==a&&"undefined"!=typeof a.obj){var b=pb.asn1.ASN1Util.newObject(a.obj);a.hex=b.getEncodedHex()}pb.asn1.DEROctetString.superclass.constructor.call(this,a),this.hT="04"},ob.lang.extend(pb.asn1.DEROctetString,pb.asn1.DERAbstractString),pb.asn1.DERNull=function(){pb.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},ob.lang.extend(pb.asn1.DERNull,pb.asn1.ASN1Object),pb.asn1.DERObjectIdentifier=function(a){var b=function(a){var b=a.toString(16);return 1==b.length&&(b="0"+b),b},c=function(a){var g,h,i,c="",d=new I(a,10),e=d.toString(2),f=7-e.length%7;for(7==f&&(f=0),g="",h=0;f>h;h++)g+="0";for(e=g+e,h=0;h<e.length-1;h+=7)i=e.substr(h,7),h!=e.length-7&&(i="1"+i),c+=b(parseInt(i,2));return c};pb.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(a){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=a},this.setValueOidString=function(a){var d,e,f,g;if(!a.match(/^[0-9.]+$/))throw"malformed oid string: "+a;for(d="",e=a.split("."),f=40*parseInt(e[0])+parseInt(e[1]),d+=b(f),e.splice(0,2),g=0;g<e.length;g++)d+=c(e[g]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=d},this.setValueName=function(a){var b=pb.asn1.x509.OID.name2oid(a);if(""===b)throw"DERObjectIdentifier oidName undefined: "+a;this.setValueOidString(b)},this.getFreshValueHex=function(){return this.hV},void 0!==a&&("string"==typeof a?a.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(a):this.setValueName(a):void 0!==a.oid?this.setValueOidString(a.oid):void 0!==a.hex?this.setValueHex(a.hex):void 0!==a.name&&this.setValueName(a.name))},ob.lang.extend(pb.asn1.DERObjectIdentifier,pb.asn1.ASN1Object),pb.asn1.DEREnumerated=function(a){pb.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(a){this.hTLV=null,this.isModified=!0,this.hV=pb.asn1.ASN1Util.bigIntToMinTwosComplementsHex(a)},this.setByInteger=function(a){var b=new I(String(a),10);this.setByBigInteger(b)},this.setValueHex=function(a){this.hV=a},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("undefined"!=typeof a["int"]?this.setByInteger(a["int"]):"number"==typeof a?this.setByInteger(a):"undefined"!=typeof a["hex"]&&this.setValueHex(a["hex"]))},ob.lang.extend(pb.asn1.DEREnumerated,pb.asn1.ASN1Object),pb.asn1.DERUTF8String=function(a){pb.asn1.DERUTF8String.superclass.constructor.call(this,a),this.hT="0c"},ob.lang.extend(pb.asn1.DERUTF8String,pb.asn1.DERAbstractString),pb.asn1.DERNumericString=function(a){pb.asn1.DERNumericString.superclass.constructor.call(this,a),this.hT="12"},ob.lang.extend(pb.asn1.DERNumericString,pb.asn1.DERAbstractString),pb.asn1.DERPrintableString=function(a){pb.asn1.DERPrintableString.superclass.constructor.call(this,a),this.hT="13"},ob.lang.extend(pb.asn1.DERPrintableString,pb.asn1.DERAbstractString),pb.asn1.DERTeletexString=function(a){pb.asn1.DERTeletexString.superclass.constructor.call(this,a),this.hT="14"},ob.lang.extend(pb.asn1.DERTeletexString,pb.asn1.DERAbstractString),pb.asn1.DERIA5String=function(a){pb.asn1.DERIA5String.superclass.constructor.call(this,a),this.hT="16"},ob.lang.extend(pb.asn1.DERIA5String,pb.asn1.DERAbstractString),pb.asn1.DERUTCTime=function(a){pb.asn1.DERUTCTime.superclass.constructor.call(this,a),this.hT="17",this.setByDate=function(a){this.hTLV=null,this.isModified=!0,this.date=a,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return"undefined"==typeof this.date&&"undefined"==typeof this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},void 0!==a&&(void 0!==a.str?this.setString(a.str):"string"==typeof a&&a.match(/^[0-9]{12}Z$/)?this.setString(a):void 0!==a.hex?this.setStringHex(a.hex):void 0!==a.date&&this.setByDate(a.date))},ob.lang.extend(pb.asn1.DERUTCTime,pb.asn1.DERAbstractTime),pb.asn1.DERGeneralizedTime=function(a){pb.asn1.DERGeneralizedTime.superclass.constructor.call(this,a),this.hT="18",this.withMillis=!1,this.setByDate=function(a){this.hTLV=null,this.isModified=!0,this.date=a,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},void 0!==a&&(void 0!==a.str?this.setString(a.str):"string"==typeof a&&a.match(/^[0-9]{14}Z$/)?this.setString(a):void 0!==a.hex?this.setStringHex(a.hex):void 0!==a.date&&this.setByDate(a.date),a.millis===!0&&(this.withMillis=!0))},ob.lang.extend(pb.asn1.DERGeneralizedTime,pb.asn1.DERAbstractTime),pb.asn1.DERSequence=function(a){pb.asn1.DERSequence.superclass.constructor.call(this,a),this.hT="30",this.getFreshValueHex=function(){var b,c,a="";for(b=0;b<this.asn1Array.length;b++)c=this.asn1Array[b],a+=c.getEncodedHex();return this.hV=a,this.hV}},ob.lang.extend(pb.asn1.DERSequence,pb.asn1.DERAbstractStructured),pb.asn1.DERSet=function(a){pb.asn1.DERSet.superclass.constructor.call(this,a),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){var b,c,a=new Array;for(b=0;b<this.asn1Array.length;b++)c=this.asn1Array[b],a.push(c.getEncodedHex());return 1==this.sortFlag&&a.sort(),this.hV=a.join(""),this.hV},"undefined"!=typeof a&&"undefined"!=typeof a.sortflag&&0==a.sortflag&&(this.sortFlag=!1)},ob.lang.extend(pb.asn1.DERSet,pb.asn1.DERAbstractStructured),pb.asn1.DERTaggedObject=function(a){pb.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(a,b,c){this.hT=b,this.isExplicit=a,this.asn1Object=c,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=c.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,b),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("undefined"!=typeof a["tag"]&&(this.hT=a["tag"]),"undefined"!=typeof a["explicit"]&&(this.isExplicit=a["explicit"]),"undefined"!=typeof a["obj"]&&(this.asn1Object=a["obj"],this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},ob.lang.extend(pb.asn1.DERTaggedObject,pb.asn1.ASN1Object),qb=function(a){function b(c){var d=a.call(this)||this;return c&&("string"==typeof c?d.parseKey(c):(b.hasPrivateKeyProperty(c)||b.hasPublicKeyProperty(c))&&d.parsePropertiesFrom(c)),d}return p(b,a),b.prototype.parseKey=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;try{if(b=0,c=0,d=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,e=d.test(a)?r.decode(a):t.unarmor(a),f=B.decode(e),3===f.sub.length&&(f=f.sub[2].sub[0]),9===f.sub.length)b=f.sub[1].getHexStringValue(),this.n=O(b,16),c=f.sub[2].getHexStringValue(),this.e=parseInt(c,16),g=f.sub[3].getHexStringValue(),this.d=O(g,16),h=f.sub[4].getHexStringValue(),this.p=O(h,16),i=f.sub[5].getHexStringValue(),this.q=O(i,16),j=f.sub[6].getHexStringValue(),this.dmp1=O(j,16),k=f.sub[7].getHexStringValue(),this.dmq1=O(k,16),l=f.sub[8].getHexStringValue(),this.coeff=O(l,16);else{if(2!==f.sub.length)return!1;m=f.sub[1],n=m.sub[0],b=n.sub[0].getHexStringValue(),this.n=O(b,16),c=n.sub[1].getHexStringValue(),this.e=parseInt(c,16)}return!0}catch(o){return!1}},b.prototype.getPrivateBaseKey=function(){var a={array:[new pb.asn1.DERInteger({"int":0}),new pb.asn1.DERInteger({bigint:this.n}),new pb.asn1.DERInteger({"int":this.e}),new pb.asn1.DERInteger({bigint:this.d}),new pb.asn1.DERInteger({bigint:this.p}),new pb.asn1.DERInteger({bigint:this.q}),new pb.asn1.DERInteger({bigint:this.dmp1}),new pb.asn1.DERInteger({bigint:this.dmq1}),new pb.asn1.DERInteger({bigint:this.coeff})]},b=new pb.asn1.DERSequence(a);return b.getEncodedHex()},b.prototype.getPrivateBaseKeyB64=function(){return m(this.getPrivateBaseKey())},b.prototype.getPublicBaseKey=function(){var a=new pb.asn1.DERSequence({array:[new pb.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new pb.asn1.DERNull]}),b=new pb.asn1.DERSequence({array:[new pb.asn1.DERInteger({bigint:this.n}),new pb.asn1.DERInteger({"int":this.e})]}),c=new pb.asn1.DERBitString({hex:"00"+b.getEncodedHex()}),d=new pb.asn1.DERSequence({array:[a,c]});return d.getEncodedHex()},b.prototype.getPublicBaseKeyB64=function(){return m(this.getPublicBaseKey())},b.wordwrap=function(a,b){if(b=b||64,!a)return a;var c="(.{1,"+b+"})( +|$\n?)|(.{1,"+b+"})";return a.match(RegExp(c,"g")).join("\n")},b.prototype.getPrivateKey=function(){var a="-----BEGIN RSA PRIVATE KEY-----\n";return a+=b.wordwrap(this.getPrivateBaseKeyB64())+"\n",a+="-----END RSA PRIVATE KEY-----"},b.prototype.getPublicKey=function(){var a="-----BEGIN PUBLIC KEY-----\n";return a+=b.wordwrap(this.getPublicBaseKeyB64())+"\n",a+="-----END PUBLIC KEY-----"},b.hasPublicKeyProperty=function(a){return a=a||{},a.hasOwnProperty("n")&&a.hasOwnProperty("e")},b.hasPrivateKeyProperty=function(a){return a=a||{},a.hasOwnProperty("n")&&a.hasOwnProperty("e")&&a.hasOwnProperty("d")&&a.hasOwnProperty("p")&&a.hasOwnProperty("q")&&a.hasOwnProperty("dmp1")&&a.hasOwnProperty("dmq1")&&a.hasOwnProperty("coeff")},b.prototype.parsePropertiesFrom=function(a){this.n=a.n,this.e=a.e,a.hasOwnProperty("d")&&(this.d=a.d,this.p=a.p,this.q=a.q,this.dmp1=a.dmp1,this.dmq1=a.dmq1,this.coeff=a.coeff)},b}(jb),rb=function(){function a(a){a=a||{},this.default_key_size=parseInt(a.default_key_size,10)||1024,this.default_public_exponent=a.default_public_exponent||"010001",this.log=a.log||!1,this.key=null}return a.prototype.setKey=function(a){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new qb(a)},a.prototype.setPrivateKey=function(a){this.setKey(a)},a.prototype.setPublicKey=function(a){this.setKey(a)},a.prototype.decrypt=function(a){try{return this.getKey().decrypt(n(a))}catch(b){return!1}},a.prototype.encrypt=function(a){try{return m(this.getKey().encrypt(a))}catch(b){return!1}},a.prototype.sign=function(a,b,c){try{return m(this.getKey().sign(a,b,c))}catch(d){return!1}},a.prototype.verify=function(a,b,c){try{return this.getKey().verify(a,n(b),c)}catch(d){return!1}},a.prototype.getKey=function(a){if(!this.key){if(this.key=new qb,a&&"[object Function]"==={}.toString.call(a))return this.key.generateAsync(this.default_key_size,this.default_public_exponent,a),void 0;this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},a.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},a.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},a.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},a.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},a.version="3.0.0-rc.1",a}(),a.JSEncrypt=rb,a.default=rb,Object.defineProperty(a,"__esModule",{value:!0})});